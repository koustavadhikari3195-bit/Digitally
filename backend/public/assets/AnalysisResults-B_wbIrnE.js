import{j as e,a as j}from"./index-DOTkGC17.js";import{e as v,r,L as k}from"./react-vendor-DmM63xa5.js";import{n as b,q as R,D as S,r as _,s as C,h as D}from"./icons-DU6nqQZT.js";import"./animation-ytRgJaM9.js";const L=()=>{const{id:o}=v(),[a,n]=r.useState(null),[g,c]=r.useState(!0),[d,m]=r.useState(!1),[x,p]=r.useState(null);r.useEffect(()=>{let s=!0;const t={score:72,summary:"Strong technical skills but lacks quantifiable impact. The resume feels generic and doesn't stand out amongst senior candidates.",top_skills:["React","Node.js","MongoDB"],missing_keywords:["System Design","CI/CD","Cloud Architecture"],critical_issues:["Passive voice used frequently","Summary is too vague"],improvement_plan:["Rewrite bullets using X-Y-Z formula","Add specific metrics to project descriptions"],job_match_prediction:"Mid-Level Frontend Developer"},l=async()=>{try{const i=localStorage.getItem("token"),u={};i&&(u.Authorization=`Bearer ${i}`);const f=await j.get(`/api/resumes/${o}`,{headers:u});s&&(f.data.analysisResult?(n(f.data.analysisResult),c(!1)):(window.__analysisRetries||(window.__analysisRetries=0),window.__analysisRetries<15?(window.__analysisRetries++,setTimeout(l,2e3)):(console.warn("Analysis timeout. Falling back to mock data."),n(t),c(!1))))}catch(i){console.error("Error fetching analysis:",i),s&&(n(t),c(!1))}};return l(),()=>{s=!1}},[o]);const y=async()=>{m(!0),p("");try{const s=localStorage.getItem("token"),t={};s&&(t.Authorization=`Bearer ${s}`);const l=await j.post("/api/chat/rewrite",{bullet:a.improvement_plan.join(". ")},{headers:t});p(l.data.rewritten)}catch(s){console.error("Rewrite failed:",s)}finally{m(!1)}},N=async()=>{const s={title:"Resume Analysis Result",text:`Check out my resume analysis score: ${a.score}/100! Result from Digitally.`,url:window.location.href};try{navigator.share?await navigator.share(s):(await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!"))}catch(t){console.error("Shared failed:",t)}},w=()=>{window.print()};if(g)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"h-12 w-12 text-primary animate-spin mx-auto mb-4"}),e.jsx("h2",{className:"text-xl text-text font-semibold",children:"Analyzing Intelligence..."}),e.jsx("p",{className:"text-text/60",children:"Parsing ATS compatibility and keywords"})]})});const h=s=>s>=80?"text-emerald-400":s>=60?"text-yellow-400":"text-red-400";return e.jsxs("div",{className:"min-h-screen pt-24 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto pb-20 print:pt-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4 print:hidden",children:[e.jsxs("div",{children:[e.jsx(k,{to:"/dashboard",className:"text-text/60 hover:text-primary mb-2 inline-block text-sm",children:"← Back to Dashboard"}),e.jsx("h1",{className:"text-3xl font-bold text-text",children:"Analysis Report"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:N,className:"btn-secondary flex items-center gap-2 transition-all hover:bg-white/10",children:[e.jsx(R,{className:"h-4 w-4"})," Share"]}),e.jsxs("button",{onClick:w,className:"btn-primary flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"})," Export PDF"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs("div",{className:"glass-panel p-8 rounded-2xl text-center",children:[e.jsx("h3",{className:"text-text/60 font-medium mb-4",children:"ATS Compatibility Score"}),e.jsxs("div",{className:"relative inline-flex items-center justify-center",children:[e.jsxs("svg",{className:"w-40 h-40 transform -rotate-90",children:[e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"10",fill:"transparent",className:"text-[var(--border-color)]"}),e.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"10",fill:"transparent",strokeDasharray:440,strokeDashoffset:440-440*a.score/100,className:h(a.score)})]}),e.jsx("span",{className:`absolute text-5xl font-bold ${h(a.score)}`,children:a.score})]}),e.jsx("p",{className:"mt-4 text-text/70 text-sm",children:a.job_match_prediction})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-2xl",children:[e.jsx("h4",{className:"text-text font-bold mb-4",children:"Top Skills Detected"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.top_skills.map((s,t)=>e.jsx("span",{className:"px-3 py-1 bg-primary/10 text-primary text-xs rounded-full border border-primary/20",children:s},t))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{className:"glass-panel p-8 rounded-2xl border-l-4 border-primary",children:[e.jsx("h3",{className:"text-xl font-bold text-text mb-2",children:"Executive Summary"}),e.jsx("p",{className:"text-text/70 leading-relaxed",children:a.summary})]}),e.jsxs("div",{className:"glass-panel p-8 rounded-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold text-text mb-6 flex items-center gap-2",children:[e.jsx(_,{className:"text-red-500"})," Critical Issues"]}),e.jsx("ul",{className:"space-y-4",children:a.critical_issues.map((s,t)=>e.jsxs("li",{className:"flex items-start gap-3 p-3 bg-red-500/5 rounded-lg border border-red-500/10",children:[e.jsx("span",{className:"text-red-400 mt-1",children:"•"}),e.jsx("span",{className:"text-text/70",children:s})]},t))})]}),e.jsxs("div",{className:"glass-panel p-8 rounded-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold text-text mb-6 flex items-center gap-2",children:[e.jsx(C,{className:"text-emerald-500"})," Improvement Plan"]}),e.jsx("ul",{className:"space-y-4",children:a.improvement_plan.map((s,t)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-500/10 flex items-center justify-center text-emerald-500 text-xs font-bold mt-0.5",children:t+1}),e.jsx("span",{className:"text-text/70",children:s})]},t))}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-[var(--border-color)] print:hidden",children:[e.jsx("h4",{className:"text-text font-medium mb-4",children:"Want these fixed automatically?"}),e.jsx("button",{onClick:y,disabled:d,className:"btn-primary w-full sm:w-auto flex items-center justify-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 animate-spin"})," Rewriting..."]}):"Rewrite with AI"})]})]}),x&&e.jsxs("div",{className:"glass-panel p-8 rounded-2xl border-2 border-emerald-500/30 bg-emerald-500/5",children:[e.jsxs("h3",{className:"text-xl font-bold text-emerald-500 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"})," Optimized Resume Bullets"]}),e.jsx("div",{className:"bg-panel p-6 rounded-xl border border-main text-text/80 whitespace-pre-wrap leading-relaxed",children:x})]})]})]})]})};export{L as default};
